!function(){"use strict";function e(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=r(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,a=function(){};return{s:a,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){u=!0,i=e},f:function(){try{c||null==n.return||n.return()}finally{if(u)throw i}}}}function t(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||r(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function o(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */o=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(R){s=function(e,t,r){return e[t]=r}}function f(e,t,r,o){var a=t&&t.prototype instanceof d?t:d,i=Object.create(a.prototype),c=new j(o||[]);return n(i,"_invoke",{value:k(e,r,c)}),i}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(R){return{type:"throw",arg:R}}}e.wrap=f;var p={};function d(){}function h(){}function y(){}var v={};s(v,i,function(){return this});var b=Object.getPrototypeOf,x=b&&b(b(P([])));x&&x!==t&&r.call(x,i)&&(v=x);var m=y.prototype=d.prototype=Object.create(v);function w(e){["next","throw","return"].forEach(function(t){s(e,t,function(e){return this._invoke(t,e)})})}function g(e,t){function o(n,a,i,c){var u=l(e[n],e,a);if("throw"!==u.type){var s=u.arg,f=s.value;return f&&"object"==typeof f&&r.call(f,"__await")?t.resolve(f.__await).then(function(e){o("next",e,i,c)},function(e){o("throw",e,i,c)}):t.resolve(f).then(function(e){s.value=e,i(s)},function(e){return o("throw",e,i,c)})}c(u.arg)}var a;n(this,"_invoke",{value:function(e,r){function n(){return new t(function(t,n){o(e,r,t,n)})}return a=a?a.then(n,n):n()}})}function k(e,t,r){var n="suspendedStart";return function(o,a){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw a;return S()}for(r.method=o,r.arg=a;;){var i=r.delegate;if(i){var c=E(i,r);if(c){if(c===p)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=l(e,t,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===p)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function E(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var o=l(n,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,p;var a=o.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function P(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:S}}function S(){return{value:void 0,done:!0}}return h.prototype=y,n(m,"constructor",{value:y,configurable:!0}),n(y,"constructor",{value:h,configurable:!0}),h.displayName=s(y,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,s(e,u,"GeneratorFunction")),e.prototype=Object.create(m),e},e.awrap=function(e){return{__await:e}},w(g.prototype),s(g.prototype,c,function(){return this}),e.AsyncIterator=g,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new g(f(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then(function(e){return e.done?e.value:i.next()})},w(m),s(m,u,"Generator"),s(m,i,function(){return this}),s(m,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=P,j.prototype={constructor:j,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return i.type="throw",i.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),_(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:P(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),p}},e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,a=void 0,"symbol"==typeof(a=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"))?a:String(a)),n)}var o,a}function c(e,t){return(c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=f(e);if(t){var o=f(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return s(this,r)}}function s(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(self.webpackChunkonTarget=self.webpackChunkonTarget||[]).push([[5143],{85075:function(r,n,s){s.r(n),s.d(n,{FilesystemWeb:function(){return h}});var f=s(34553),l=s(68384);function p(e){var t=e.split("/").filter(function(e){return"."!==e}),r=[];return t.forEach(function(e){".."===e&&r.length>0&&".."!==r[r.length-1]?r.pop():r.push(e)}),r.join("/")}var d,h=((d=function(r){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(h,r);var n,s,l,d=u(h);function h(){var e;return a(this,h),(e=d.apply(this,arguments)).DB_VERSION=1,e.DB_NAME="Disc",e._writeCmds=["add","put","delete"],e}return n=h,l=[{key:"doUpgrade",value:function(e){var t=e.target.result;switch(e.oldVersion){case 0:case 1:default:t.objectStoreNames.contains("FileStorage")&&t.deleteObjectStore("FileStorage"),t.createObjectStore("FileStorage",{keyPath:"path"}).createIndex("by_folder","folder")}}}],(s=[{key:"initDb",value:function(){var e=this;return(0,f.Z)(o().mark(function t(){return o().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===e._db){t.next=2;break}return t.abrupt("return",e._db);case 2:if("indexedDB"in window){t.next=4;break}throw e.unavailable("This browser doesn't support IndexedDB");case 4:return t.abrupt("return",new Promise(function(t,r){var n=indexedDB.open(e.DB_NAME,e.DB_VERSION);n.onupgradeneeded=h.doUpgrade,n.onsuccess=function(){e._db=n.result,t(n.result)},n.onerror=function(){return r(n.error)},n.onblocked=function(){console.warn("db blocked")}}));case 5:case"end":return t.stop()}},t)}))()}},{key:"dbRequest",value:function(e,r){var n=this;return(0,f.Z)(o().mark(function a(){var i;return o().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return i=-1!==n._writeCmds.indexOf(e)?"readwrite":"readonly",o.abrupt("return",n.initDb().then(function(n){return new Promise(function(o,a){var c,u=(c=n.transaction(["FileStorage"],i).objectStore("FileStorage"))[e].apply(c,t(r));u.onsuccess=function(){return o(u.result)},u.onerror=function(){return a(u.error)}})}));case 2:case"end":return o.stop()}},a)}))()}},{key:"dbIndexRequest",value:function(e,r,n){var a=this;return(0,f.Z)(o().mark(function i(){var c;return o().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return c=-1!==a._writeCmds.indexOf(r)?"readwrite":"readonly",o.abrupt("return",a.initDb().then(function(o){return new Promise(function(a,i){var u,s=(u=o.transaction(["FileStorage"],c).objectStore("FileStorage").index(e))[r].apply(u,t(n));s.onsuccess=function(){return a(s.result)},s.onerror=function(){return i(s.error)}})}));case 2:case"end":return o.stop()}},i)}))()}},{key:"getPath",value:function(e,t){var r=void 0!==t?t.replace(/^[/]+|[/]+$/g,""):"",n="";return void 0!==e&&(n+="/"+e),""!==t&&(n+="/"+r),n}},{key:"clear",value:function(){var e=this;return(0,f.Z)(o().mark(function t(){return o().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.initDb();case 2:t.sent.transaction(["FileStorage"],"readwrite").objectStore("FileStorage").clear();case 3:case"end":return t.stop()}},t)}))()}},{key:"readFile",value:function(e){var t=this;return(0,f.Z)(o().mark(function r(){var n,a;return o().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n=t.getPath(e.directory,e.path),r.next=3,t.dbRequest("get",[n]);case 3:if(void 0!==(a=r.sent)){r.next=6;break}throw Error("File does not exist.");case 6:return r.abrupt("return",{data:a.content?a.content:""});case 7:case"end":return r.stop()}},r)}))()}},{key:"writeFile",value:function(e){var t=this;return(0,f.Z)(o().mark(function r(){var n,a,i,c,u,s,f,l,p,d;return o().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n=t.getPath(e.directory,e.path),a=e.data,i=e.recursive,r.next=5,t.dbRequest("get",[n]);case 5:if(!(c=r.sent)||"directory"!==c.type){r.next=8;break}throw Error("The supplied path is a directory.");case 8:return u=e.encoding,s=n.substr(0,n.lastIndexOf("/")),r.t0=void 0,r.next=12,t.dbRequest("get",[s]);case 12:if(r.t1=r.sent,r.t0!==r.t1){r.next=19;break}if(-1===(f=s.indexOf("/",1))){r.next=19;break}return l=s.substr(f),r.next=19,t.mkdir({path:l,directory:e.directory,recursive:i});case 19:return p=Date.now(),d={path:n,folder:s,type:"file",size:a.length,ctime:p,mtime:p,content:!u&&a.indexOf(",")>=0?a.split(",")[1]:a},r.next=22,t.dbRequest("put",[d]);case 22:return r.abrupt("return",{uri:d.path});case 23:case"end":return r.stop()}},r)}))()}},{key:"appendFile",value:function(e){var t=this;return(0,f.Z)(o().mark(function r(){var n,a,i,c,u,s,f,l,p;return o().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n=t.getPath(e.directory,e.path),a=e.data,i=n.substr(0,n.lastIndexOf("/")),c=Date.now(),u=c,r.next=6,t.dbRequest("get",[n]);case 6:if(!(s=r.sent)||"directory"!==s.type){r.next=9;break}throw Error("The supplied path is a directory.");case 9:return r.t0=void 0,r.next=12,t.dbRequest("get",[i]);case 12:if(r.t1=r.sent,r.t0!==r.t1){r.next=19;break}if(-1===(f=i.indexOf("/",1))){r.next=19;break}return l=i.substr(f),r.next=19,t.mkdir({path:l,directory:e.directory,recursive:!0});case 19:return void 0!==s&&(a=s.content+a,u=s.ctime),p={path:n,folder:i,type:"file",size:a.length,ctime:u,mtime:c,content:a},r.next=23,t.dbRequest("put",[p]);case 23:case"end":return r.stop()}},r)}))()}},{key:"deleteFile",value:function(e){var t=this;return(0,f.Z)(o().mark(function r(){var n;return o().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n=t.getPath(e.directory,e.path),r.t0=void 0,r.next=4,t.dbRequest("get",[n]);case 4:if(r.t1=r.sent,r.t0!==r.t1){r.next=7;break}throw Error("File does not exist.");case 7:return r.next=9,t.dbIndexRequest("by_folder","getAllKeys",[IDBKeyRange.only(n)]);case 9:if(r.t2=r.sent.length,0===r.t2){r.next=12;break}throw Error("Folder is not empty.");case 12:return r.next=14,t.dbRequest("delete",[n]);case 14:case"end":return r.stop()}},r)}))()}},{key:"mkdir",value:function(e){var t=this;return(0,f.Z)(o().mark(function r(){var n,a,i,c,u,s,f,l,p;return o().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n=t.getPath(e.directory,e.path),a=e.recursive,i=n.substr(0,n.lastIndexOf("/")),c=(n.match(/\//g)||[]).length,r.next=6,t.dbRequest("get",[i]);case 6:return u=r.sent,r.next=9,t.dbRequest("get",[n]);case 9:if(s=r.sent,1!==c){r.next=12;break}throw Error("Cannot create Root directory");case 12:if(void 0===s){r.next=14;break}throw Error("Current directory does already exist.");case 14:if(a||2===c||void 0!==u){r.next=16;break}throw Error("Parent directory must exist");case 16:if(!a||2===c||void 0!==u){r.next=20;break}return f=i.substr(i.indexOf("/",1)),r.next=20,t.mkdir({path:f,directory:e.directory,recursive:a});case 20:return l=Date.now(),p={path:n,folder:i,type:"directory",size:0,ctime:l,mtime:l},r.next=23,t.dbRequest("put",[p]);case 23:case"end":return r.stop()}},r)}))()}},{key:"rmdir",value:function(t){var r=this;return(0,f.Z)(o().mark(function n(){var a,i,c,u,s,f,l,p,d,h;return o().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a=t.path,i=t.directory,c=t.recursive,u=r.getPath(i,a),n.next=6,r.dbRequest("get",[u]);case 6:if(void 0!==(s=n.sent)){n.next=9;break}throw Error("Folder does not exist.");case 9:if("directory"===s.type){n.next=11;break}throw Error("Requested path is not a directory");case 11:return n.next=13,r.readdir({path:a,directory:i});case 13:if(0===(f=n.sent).files.length||c){n.next=16;break}throw Error("Folder is not empty");case 16:l=e(f.files),n.prev=17,l.s();case 19:if((p=l.n()).done){n.next=34;break}return d=p.value,h="".concat(a,"/").concat(d),n.next=24,r.stat({path:h,directory:i});case 24:if(n.t0=n.sent.type,"file"!==n.t0){n.next=30;break}return n.next=28,r.deleteFile({path:h,directory:i});case 28:n.next=32;break;case 30:return n.next=32,r.rmdir({path:h,directory:i,recursive:c});case 32:n.next=19;break;case 34:n.next=39;break;case 36:n.prev=36,n.t1=n.catch(17),l.e(n.t1);case 39:return n.prev=39,l.f(),n.finish(39);case 42:return n.next=44,r.dbRequest("delete",[u]);case 44:case"end":return n.stop()}},n,null,[[17,36,39,42]])}))()}},{key:"readdir",value:function(e){var t=this;return(0,f.Z)(o().mark(function r(){var n,a;return o().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n=t.getPath(e.directory,e.path),r.next=3,t.dbRequest("get",[n]);case 3:if(a=r.sent,""===e.path||void 0!==a){r.next=6;break}throw Error("Folder does not exist.");case 6:return r.next=8,t.dbIndexRequest("by_folder","getAllKeys",[IDBKeyRange.only(n)]);case 8:return r.t0=r.sent.map(function(e){return e.substring(n.length+1)}),r.abrupt("return",{files:r.t0});case 10:case"end":return r.stop()}},r)}))()}},{key:"getUri",value:function(e){var t=this;return(0,f.Z)(o().mark(function r(){var n,a;return o().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n=t.getPath(e.directory,e.path),r.next=3,t.dbRequest("get",[n]);case 3:if(a=r.sent,r.t0=void 0===a,!r.t0){r.next=9;break}return r.next=8,t.dbRequest("get",[n+"/"]);case 8:a=r.sent;case 9:return r.abrupt("return",{uri:(null==a?void 0:a.path)||n});case 10:case"end":return r.stop()}},r)}))()}},{key:"stat",value:function(e){var t=this;return(0,f.Z)(o().mark(function r(){var n,a;return o().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n=t.getPath(e.directory,e.path),r.next=3,t.dbRequest("get",[n]);case 3:if(a=r.sent,r.t0=void 0===a,!r.t0){r.next=9;break}return r.next=8,t.dbRequest("get",[n+"/"]);case 8:a=r.sent;case 9:if(void 0!==a){r.next=11;break}throw Error("Entry does not exist.");case 11:return r.abrupt("return",{type:a.type,size:a.size,ctime:a.ctime,mtime:a.mtime,uri:a.path});case 12:case"end":return r.stop()}},r)}))()}},{key:"rename",value:function(e){var t=this;return(0,f.Z)(o().mark(function r(){return o().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",t._copy(e,!0));case 1:case"end":return r.stop()}},r)}))()}},{key:"copy",value:function(e){var t=this;return(0,f.Z)(o().mark(function r(){return o().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",t._copy(e,!1));case 1:case"end":return r.stop()}},r)}))()}},{key:"requestPermissions",value:function(){return(0,f.Z)(o().mark(function e(){return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{publicStorage:"granted"});case 1:case"end":return e.stop()}},e)}))()}},{key:"checkPermissions",value:function(){return(0,f.Z)(o().mark(function e(){return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{publicStorage:"granted"});case 1:case"end":return e.stop()}},e)}))()}},{key:"_copy",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;return(0,f.Z)(o().mark(function a(){var i,c,u,s,l,d,h,y,v,b,x,m,w,g,k,E,O;return o().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(i=t.toDirectory,c=t.to,u=t.from,s=t.directory,c&&u){a.next=4;break}throw Error("Both to and from must be provided");case 4:if(i||(i=s),l=n.getPath(s,u),d=n.getPath(i,c),l!==d){a.next=8;break}return a.abrupt("return");case 8:if(!function(e,t){e=p(e),t=p(t);var r=e.split("/"),n=t.split("/");return e!==t&&r.every(function(e,t){return e===n[t]})}(l,d)){a.next=10;break}throw Error("To path cannot contain the from path");case 10:return a.prev=10,a.next=13,n.stat({path:c,directory:i});case 13:h=a.sent,a.next=29;break;case 16:if(a.prev=16,a.t0=a.catch(10),(y=c.split("/")).pop(),v=y.join("/"),a.t1=y.length>0,!a.t1){a.next=27;break}return a.next=25,n.stat({path:v,directory:i});case 25:a.t2=a.sent.type,a.t1="directory"!==a.t2;case 27:if(!a.t1){a.next=29;break}throw new Error("Parent directory of the to path is a file");case 29:if(!h||"directory"!==h.type){a.next=31;break}throw new Error("Cannot overwrite a directory with a file");case 31:return a.next=33,n.stat({path:u,directory:s});case 33:b=a.sent,x=function(){var e=(0,f.Z)(o().mark(function e(t,r,a){var c,u;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c=n.getPath(i,t),e.next=3,n.dbRequest("get",[c]);case 3:return(u=e.sent).ctime=r,u.mtime=a,e.next=8,n.dbRequest("put",[u]);case 8:case"end":return e.stop()}},e)}));return function(t,r,n){return e.apply(this,arguments)}}(),m=b.ctime?b.ctime:Date.now(),a.t3=b.type,a.next="file"===a.t3?39:"directory"===a.t3?54:91;break;case 39:return a.next=41,n.readFile({path:u,directory:s});case 41:if(w=a.sent,a.t4=r,!a.t4){a.next=46;break}return a.next=46,n.deleteFile({path:u,directory:s});case 46:return a.next=48,n.writeFile({path:c,directory:i,data:w.data});case 48:if(a.t5=r,!a.t5){a.next=53;break}return a.next=52,x(c,m,b.mtime);case 52:a.t5=a.sent;case 53:return a.abrupt("return",void a.t5);case 54:if(!h){a.next=56;break}throw Error("Cannot move a directory over an existing object");case 56:return a.prev=56,a.next=59,n.mkdir({path:c,directory:i,recursive:!1});case 59:if(a.t6=r,!a.t6){a.next=63;break}return a.next=63,x(c,m,b.mtime);case 63:a.next=67;break;case 65:a.prev=65,a.t7=a.catch(56);case 67:return a.next=69,n.readdir({path:u,directory:s});case 69:g=a.sent.files,k=e(g),a.prev=71,k.s();case 73:if((E=k.n()).done){a.next=79;break}return O=E.value,a.next=77,n._copy({from:"".concat(u,"/").concat(O),to:"".concat(c,"/").concat(O),directory:s,toDirectory:i},r);case 77:a.next=73;break;case 79:a.next=84;break;case 81:a.prev=81,a.t8=a.catch(71),k.e(a.t8);case 84:return a.prev=84,k.f(),a.finish(84);case 87:if(a.t9=r,!a.t9){a.next=91;break}return a.next=91,n.rmdir({path:u,directory:s});case 91:case"end":return a.stop()}},a,null,[[10,16],[56,65],[71,81,84,87]])}))()}}])&&i(n.prototype,s),l&&i(n,l),Object.defineProperty(n,"prototype",{writable:!1}),h}(l.Uw))._debug=!0,d)}}])}();