{"ast":null,"code":"import { EventEmitter, Component, ElementRef, Renderer2, Input, Output, NgModule } from '@angular/core';\n\n/**\n * @fileoverview added by tsickle\n * Generated from: lib/angular-cd-timer.component.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\nimport * as ɵngcc0 from '@angular/core';\nconst _c0 = [\"*\"];\nlet CdTimerComponent = /*#__PURE__*/(() => {\n  class CdTimerComponent {\n    /**\n     * @param {?} elt\n     * @param {?} renderer\n     */\n    constructor(elt, renderer) {\n      this.elt = elt;\n      this.renderer = renderer;\n      this.onStart = new EventEmitter();\n      this.onStop = new EventEmitter();\n      this.onTick = new EventEmitter();\n      this.onComplete = new EventEmitter();\n      // Initialization\n      this.autoStart = true;\n      this.startTime = 0;\n      this.endTime = 0;\n      this.timeoutId = null;\n      this.countdown = false;\n      this.format = 'default';\n    }\n    /**\n     * @return {?}\n     */\n    ngAfterViewInit() {\n      /** @type {?} */\n      const ngContentNode = this.elt.nativeElement.lastChild;\n      this.ngContentSchema = ngContentNode ? ngContentNode.nodeValue : '';\n      if (this.autoStart === undefined || this.autoStart === true) {\n        this.start();\n      }\n    }\n    /**\n     * @return {?}\n     */\n    ngOnDestroy() {\n      this.resetTimeout();\n    }\n    /**\n     * Start the timer\n     * @return {?}\n     */\n    start() {\n      this.initVar();\n      this.resetTimeout();\n      this.computeTimeUnits();\n      this.startTickCount();\n      this.onStart.emit(this);\n    }\n    /**\n     * Resume the timer\n     * @return {?}\n     */\n    resume() {\n      this.resetTimeout();\n      this.startTickCount();\n    }\n    /**\n     * Stop the timer\n     * @return {?}\n     */\n    stop() {\n      this.clear();\n      this.onStop.emit(this);\n    }\n    /**\n     * Reset the timer\n     * @return {?}\n     */\n    reset() {\n      this.initVar();\n      this.resetTimeout();\n      this.clear();\n      this.computeTimeUnits();\n      this.renderText();\n    }\n    /**\n     * Get the time information\n     * @return {?} TimeInterface\n     */\n    get() {\n      return {\n        seconds: this.seconds,\n        minutes: this.minutes,\n        hours: this.hours,\n        days: this.days,\n        timer: this.timeoutId,\n        tick_count: this.tickCounter\n      };\n    }\n    /**\n     * Initialize variable before start\n     * @private\n     * @return {?}\n     */\n    initVar() {\n      this.startTime = this.startTime || 0;\n      this.endTime = this.endTime || 0;\n      this.countdown = this.countdown || false;\n      this.tickCounter = this.startTime;\n      // Disable countdown if start time not defined\n      if (this.countdown && this.startTime === 0) {\n        this.countdown = false;\n      }\n      // Determine auto format\n      if (!this.format) {\n        this.format = this.ngContentSchema.length > 5 ? 'user' : 'default';\n      }\n    }\n    /**\n     * Reset timeout\n     * @private\n     * @return {?}\n     */\n    resetTimeout() {\n      if (this.timeoutId) {\n        clearInterval(this.timeoutId);\n      }\n    }\n    /**\n     * Render the time to DOM\n     * @private\n     * @return {?}\n     */\n    renderText() {\n      /** @type {?} */\n      let outputText;\n      if (this.format === 'user') {\n        // User presentation\n        /** @type {?} */\n        const items = {\n          'seconds': this.seconds,\n          'minutes': this.minutes,\n          'hours': this.hours,\n          'days': this.days\n        };\n        outputText = this.ngContentSchema;\n        for (const key of Object.keys(items)) {\n          outputText = outputText.replace('[' + key + ']', /** @type {?} */items[key].toString());\n        }\n      } else if (this.format === 'intelli') {\n        // Intelli presentation\n        outputText = '';\n        if (this.days > 0) {\n          outputText += this.days.toString() + 'day' + (this.days > 1 ? 's' : '') + ' ';\n        }\n        if (this.hours > 0 || this.days > 0) {\n          outputText += this.hours.toString() + 'h ';\n        }\n        if ((this.minutes > 0 || this.hours > 0) && this.days === 0) {\n          outputText += this.minutes.toString().padStart(2, '0') + 'min ';\n        }\n        if (this.hours === 0 && this.days === 0) {\n          outputText += this.seconds.toString().padStart(2, '0') + 's';\n        }\n      } else if (this.format === 'hms') {\n        // Hms presentation\n        outputText = this.hours.toString().padStart(2, '0') + ':';\n        outputText += this.minutes.toString().padStart(2, '0') + ':';\n        outputText += this.seconds.toString().padStart(2, '0');\n      } else {\n        // Default presentation\n        outputText = this.days.toString() + 'd ';\n        outputText += this.hours.toString() + 'h ';\n        outputText += this.minutes.toString() + 'm ';\n        outputText += this.seconds.toString() + 's';\n      }\n      this.renderer.setProperty(this.elt.nativeElement, 'innerHTML', outputText);\n    }\n    /**\n     * @private\n     * @return {?}\n     */\n    clear() {\n      this.resetTimeout();\n      this.timeoutId = null;\n    }\n    /**\n     * Compute each unit (seconds, minutes, hours, days) for further manipulation\n     * @protected\n     * @return {?}\n     */\n    computeTimeUnits() {\n      if (!this.maxTimeUnit || this.maxTimeUnit === 'day') {\n        this.seconds = Math.floor(this.tickCounter % 60);\n        this.minutes = Math.floor(this.tickCounter / 60 % 60);\n        this.hours = Math.floor(this.tickCounter / 3600 % 24);\n        this.days = Math.floor(this.tickCounter / 3600 / 24);\n      } else if (this.maxTimeUnit === 'second') {\n        this.seconds = this.tickCounter;\n        this.minutes = 0;\n        this.hours = 0;\n        this.days = 0;\n      } else if (this.maxTimeUnit === 'minute') {\n        this.seconds = Math.floor(this.tickCounter % 60);\n        this.minutes = Math.floor(this.tickCounter / 60);\n        this.hours = 0;\n        this.days = 0;\n      } else if (this.maxTimeUnit === 'hour') {\n        this.seconds = Math.floor(this.tickCounter % 60);\n        this.minutes = Math.floor(this.tickCounter / 60 % 60);\n        this.hours = Math.floor(this.tickCounter / 3600);\n        this.days = 0;\n      }\n      this.renderText();\n    }\n    /**\n     * Start tick count, base of this component\n     * @protected\n     * @return {?}\n     */\n    startTickCount() {\n      /** @type {?} */\n      const that = this;\n      that.timeoutId = setInterval(\n      /**\n      * @return {?}\n      */\n      function () {\n        /** @type {?} */\n        let counter;\n        if (that.countdown) {\n          // Compute finish counter for countdown\n          counter = that.tickCounter;\n          if (that.startTime > that.endTime) {\n            counter = that.tickCounter - that.endTime - 1;\n          }\n        } else {\n          // Compute finish counter for timer\n          counter = that.tickCounter - that.startTime;\n          if (that.endTime > that.startTime) {\n            counter = that.endTime - that.tickCounter - 1;\n          }\n        }\n        that.computeTimeUnits();\n        /** @type {?} */\n        const timer = {\n          seconds: that.seconds,\n          minutes: that.minutes,\n          hours: that.hours,\n          days: that.days,\n          timer: that.timeoutId,\n          tick_count: that.tickCounter\n        };\n        that.onTick.emit(timer);\n        if (counter < 0) {\n          that.stop();\n          that.onComplete.emit(that);\n          return;\n        }\n        if (that.countdown) {\n          that.tickCounter--;\n        } else {\n          that.tickCounter++;\n        }\n      }, 1000); // Each seconds\n    }\n  }\n\n  CdTimerComponent.ɵfac = function CdTimerComponent_Factory(t) {\n    return new (t || CdTimerComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Renderer2));\n  };\n  CdTimerComponent.ɵcmp = /*@__PURE__*/ɵngcc0.ɵɵdefineComponent({\n    type: CdTimerComponent,\n    selectors: [[\"cd-timer\"]],\n    inputs: {\n      autoStart: \"autoStart\",\n      startTime: \"startTime\",\n      endTime: \"endTime\",\n      countdown: \"countdown\",\n      format: \"format\",\n      maxTimeUnit: \"maxTimeUnit\"\n    },\n    outputs: {\n      onStart: \"onStart\",\n      onStop: \"onStop\",\n      onTick: \"onTick\",\n      onComplete: \"onComplete\"\n    },\n    ngContentSelectors: _c0,\n    decls: 1,\n    vars: 0,\n    template: function CdTimerComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        ɵngcc0.ɵɵprojectionDef();\n        ɵngcc0.ɵɵprojection(0);\n      }\n    },\n    encapsulation: 2\n  });\n  /** @nocollapse */\n  return CdTimerComponent;\n})();\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\nif (false) {\n  /**\n   * @type {?}\n   * @private\n   */\n  CdTimerComponent.prototype.timeoutId;\n  /**\n   * @type {?}\n   * @private\n   */\n  CdTimerComponent.prototype.tickCounter;\n  /**\n   * @type {?}\n   * @private\n   */\n  CdTimerComponent.prototype.ngContentSchema;\n  /**\n   * @type {?}\n   * @private\n   */\n  CdTimerComponent.prototype.seconds;\n  /**\n   * @type {?}\n   * @private\n   */\n  CdTimerComponent.prototype.minutes;\n  /**\n   * @type {?}\n   * @private\n   */\n  CdTimerComponent.prototype.hours;\n  /**\n   * @type {?}\n   * @private\n   */\n  CdTimerComponent.prototype.days;\n  /** @type {?} */\n  CdTimerComponent.prototype.startTime;\n  /** @type {?} */\n  CdTimerComponent.prototype.endTime;\n  /** @type {?} */\n  CdTimerComponent.prototype.countdown;\n  /** @type {?} */\n  CdTimerComponent.prototype.autoStart;\n  /** @type {?} */\n  CdTimerComponent.prototype.maxTimeUnit;\n  /** @type {?} */\n  CdTimerComponent.prototype.format;\n  /** @type {?} */\n  CdTimerComponent.prototype.onStart;\n  /** @type {?} */\n  CdTimerComponent.prototype.onStop;\n  /** @type {?} */\n  CdTimerComponent.prototype.onTick;\n  /** @type {?} */\n  CdTimerComponent.prototype.onComplete;\n  /**\n   * @type {?}\n   * @private\n   */\n  CdTimerComponent.prototype.elt;\n  /**\n   * @type {?}\n   * @private\n   */\n  CdTimerComponent.prototype.renderer;\n}\n\n/**\n * @fileoverview added by tsickle\n * Generated from: lib/angular-cd-timer.interface.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n/**\n * @record\n */\nfunction TimeInterface() {}\nif (false) {\n  /** @type {?} */\n  TimeInterface.prototype.tick_count;\n  /** @type {?} */\n  TimeInterface.prototype.seconds;\n  /** @type {?} */\n  TimeInterface.prototype.minutes;\n  /** @type {?} */\n  TimeInterface.prototype.hours;\n  /** @type {?} */\n  TimeInterface.prototype.days;\n  /** @type {?} */\n  TimeInterface.prototype.timer;\n}\n\n/**\n * @fileoverview added by tsickle\n * Generated from: lib/angular-cd-timer.module.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\nlet CdTimerModule = /*#__PURE__*/(() => {\n  class CdTimerModule {}\n  CdTimerModule.ɵfac = function CdTimerModule_Factory(t) {\n    return new (t || CdTimerModule)();\n  };\n  CdTimerModule.ɵmod = /*@__PURE__*/ɵngcc0.ɵɵdefineNgModule({\n    type: CdTimerModule\n  });\n  CdTimerModule.ɵinj = /*@__PURE__*/ɵngcc0.ɵɵdefineInjector({\n    imports: [[]]\n  });\n  return CdTimerModule;\n})();\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n(function () {\n  (typeof ngJitMode === \"undefined\" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(CdTimerModule, {\n    declarations: [CdTimerComponent],\n    exports: [CdTimerComponent]\n  });\n})();\n\n/**\n * @fileoverview added by tsickle\n * Generated from: public-api.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n\n/**\n * @fileoverview added by tsickle\n * Generated from: angular-cd-timer.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n\nexport { CdTimerComponent, CdTimerModule };\n\n//# sourceMappingURL=angular-cd-timer.js.map","map":null,"metadata":{},"sourceType":"module"}