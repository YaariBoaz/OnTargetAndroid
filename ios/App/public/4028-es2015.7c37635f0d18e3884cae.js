"use strict";(self.webpackChunkonTarget=self.webpackChunkonTarget||[]).push([[4028],{14028:function(e,t,n){n.r(t),n.d(t,{CameraWeb:function(){return i},Camera:function(){return c}});var r=n(34553),a=n(68384),o=n(64021);class i extends a.Uw{getPhoto(e){var t=this;return(0,r.Z)(function*(){return new Promise(function(){var n=(0,r.Z)(function*(n,a){if(e.webUseInput||e.source===o.oK.Photos)t.fileInputExperience(e,n);else if(e.source===o.oK.Prompt){let o=document.querySelector("pwa-action-sheet");o||(o=document.createElement("pwa-action-sheet"),document.body.appendChild(o)),o.header=e.promptLabelHeader||"Photo",o.cancelable=!1,o.options=[{title:e.promptLabelPhoto||"From Photos"},{title:e.promptLabelPicture||"Take Picture"}],o.addEventListener("onSelection",function(){var o=(0,r.Z)(function*(r){0===r.detail?t.fileInputExperience(e,n):t.cameraExperience(e,n,a)});return function(e){return o.apply(this,arguments)}}())}else t.cameraExperience(e,n,a)});return function(e,t){return n.apply(this,arguments)}}())})()}pickImages(e){var t=this;return(0,r.Z)(function*(){return new Promise(function(){var e=(0,r.Z)(function*(e){t.multipleFileInputExperience(e)});return function(t){return e.apply(this,arguments)}}())})()}cameraExperience(e,t,n){var i=this;return(0,r.Z)(function*(){if(customElements.get("pwa-camera-modal")){const s=document.createElement("pwa-camera-modal");s.facingMode=e.direction===o.GW.Front?"user":"environment",document.body.appendChild(s);try{yield s.componentOnReady(),s.addEventListener("onPhoto",function(){var o=(0,r.Z)(function*(r){const o=r.detail;null===o?n(new a.xz("User cancelled photos app")):o instanceof Error?n(o):t(yield i._getCameraPhoto(o,e)),s.dismiss(),document.body.removeChild(s)});return function(e){return o.apply(this,arguments)}}()),s.present()}catch(c){i.fileInputExperience(e,t)}}else console.error("Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/pwa-elements."),i.fileInputExperience(e,t)})()}fileInputExperience(e,t){let n=document.querySelector("#_capacitor-camera-input");const r=()=>{var e;null===(e=n.parentNode)||void 0===e||e.removeChild(n)};n||(n=document.createElement("input"),n.id="_capacitor-camera-input",n.type="file",n.hidden=!0,document.body.appendChild(n),n.addEventListener("change",a=>{const o=n.files[0];let i="jpeg";if("image/png"===o.type?i="png":"image/gif"===o.type&&(i="gif"),"dataUrl"===e.resultType||"base64"===e.resultType){const n=new FileReader;n.addEventListener("load",()=>{if("dataUrl"===e.resultType)t({dataUrl:n.result,format:i});else if("base64"===e.resultType){const e=n.result.split(",")[1];t({base64String:e,format:i})}r()}),n.readAsDataURL(o)}else t({webPath:URL.createObjectURL(o),format:i}),r()})),n.accept="image/*",n.capture=!0,e.source===o.oK.Photos||e.source===o.oK.Prompt?n.removeAttribute("capture"):e.direction===o.GW.Front?n.capture="user":e.direction===o.GW.Rear&&(n.capture="environment"),n.click()}multipleFileInputExperience(e){let t=document.querySelector("#_capacitor-camera-input-multiple");t||(t=document.createElement("input"),t.id="_capacitor-camera-input-multiple",t.type="file",t.hidden=!0,t.multiple=!0,document.body.appendChild(t),t.addEventListener("change",n=>{const r=[];for(let e=0;e<t.files.length;e++){const n=t.files[e];let a="jpeg";"image/png"===n.type?a="png":"image/gif"===n.type&&(a="gif"),r.push({webPath:URL.createObjectURL(n),format:a})}e({photos:r}),(()=>{var e;null===(e=t.parentNode)||void 0===e||e.removeChild(t)})()})),t.accept="image/*",t.click()}_getCameraPhoto(e,t){return new Promise((n,r)=>{const a=new FileReader,o=e.type.split("/")[1];"uri"===t.resultType?n({webPath:URL.createObjectURL(e),format:o,saved:!1}):(a.readAsDataURL(e),a.onloadend=()=>{const e=a.result;n("dataUrl"===t.resultType?{dataUrl:e,format:o,saved:!1}:{base64String:e.split(",")[1],format:o,saved:!1})},a.onerror=e=>{r(e)})})}checkPermissions(){var e=this;return(0,r.Z)(function*(){if("undefined"==typeof navigator||!navigator.permissions)throw e.unavailable("Permissions API not available in this browser");try{return{camera:(yield window.navigator.permissions.query({name:"camera"})).state,photos:"granted"}}catch(t){throw e.unavailable("Camera permissions are not available in this browser")}})()}requestPermissions(){var e=this;return(0,r.Z)(function*(){throw e.unimplemented("Not implemented on web.")})()}}const c=new i}}]);